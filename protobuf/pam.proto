syntax = "proto3";

package pam;
option go_package = "pkg/pb";

import "agent.proto";

service PAM {
    rpc TokenAuth(TokenAuthRequest) returns (TokenAuthResponse);
    rpc InteractiveAuth(stream InteractiveResponse) returns (stream InteractiveChallenge);
}

message TokenAuthRequest {
    string username = 1;
    string token = 2;
}

message TokenAuthResponse {
    bool successful = 1;
    agent.Token token = 2;
}

message InteractiveResponse {
    bool init = 1;
    repeated string values = 2;
}

message InteractiveChallenge {
    bool finished = 1;
    string component = 2;
    string prompt = 3;
}
